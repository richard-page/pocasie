<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Počasie - Open Meteo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        body { 
            font-family: 'Inter', sans-serif; 
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        .weather-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            animation: gradientShift 10s ease infinite;
        }
        
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 25px 45px rgba(0, 0, 0, 0.1);
        }
        
        .glass-card-dark {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.15);
        }
        
        .weather-icon {
            font-size: 4rem;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.2));
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .slide-up {
            animation: slideUp 0.5s ease-out;
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .pulse-glow {
            animation: pulseGlow 2s ease-in-out infinite;
        }
        
        @keyframes pulseGlow {
            0%, 100% { box-shadow: 0 0 20px rgba(255, 255, 255, 0.3); }
            50% { box-shadow: 0 0 30px rgba(255, 255, 255, 0.5); }
        }
        
        .search-input {
            transition: all 0.3s ease;
        }
        
        .search-input:focus {
            transform: scale(1.02);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .forecast-card {
            transition: all 0.3s ease;
        }
        
        .forecast-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        }
        
        /* Mobile optimizations */
        @media (max-width: 640px) {
            .weather-icon {
                font-size: 3rem;
            }
            
            .mobile-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.75rem;
            }
            
            .mobile-forecast {
                grid-template-columns: repeat(3, 1fr);
                gap: 0.5rem;
            }
            
            .mobile-text-sm {
                font-size: 0.875rem;
            }
            
            .mobile-padding {
                padding: 1rem;
            }
        }
        
        /* Touch-friendly buttons */
        .touch-button {
            min-height: 44px;
            min-width: 44px;
        }
        
        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }
        
        /* Loading animation */
        .loading-spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 3px solid white;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="min-h-screen weather-gradient bg-size-200">
    <div class="container mx-auto px-4 py-6 sm:py-8">
        <!-- Header -->
        <div class="text-center mb-6 sm:mb-8 fade-in">
            <h1 class="text-3xl sm:text-4xl md:text-6xl font-bold text-white mb-2 sm:mb-4">
                🌤️ Počasie
            </h1>
            <p class="text-lg sm:text-xl text-white/90 font-medium">
                Presné údaje z Open Meteo
            </p>
        </div>

        <!-- Search Section -->
        <div class="max-w-md mx-auto mb-6 sm:mb-8 slide-up">
            <div class="relative">
                <input 
                    type="text" 
                    id="cityInput" 
                    placeholder="Zadaj názov mesta..."
                    class="search-input w-full px-4 py-3 sm:py-4 rounded-2xl glass-card text-white placeholder-white/80 focus:outline-none focus:ring-2 focus:ring-white/50 text-base sm:text-lg font-medium"
                >
                <button 
                    onclick="searchWeather()" 
                    class="touch-button absolute right-2 top-1/2 transform -translate-y-1/2 px-4 py-2 bg-white/30 hover:bg-white/40 rounded-xl text-white transition-all duration-300 font-medium"
                >
                    🔍
                </button>
            </div>
        </div>

        <!-- Current Weather Card -->
        <div id="currentWeather" class="glass-card rounded-3xl mobile-padding sm:p-8 mb-6 sm:mb-8 text-white max-w-2xl mx-auto fade-in pulse-glow">
            <div class="text-center">
                <h2 class="text-xl sm:text-2xl font-bold mb-3 sm:mb-4" id="cityName">Bratislava</h2>
                <div class="weather-icon mb-4" id="weatherIcon">☀️</div>
                <div class="text-4xl sm:text-5xl md:text-6xl font-bold mb-2 sm:mb-3" id="temperature">22°C</div>
                <div class="text-lg sm:text-xl mb-4 sm:mb-6 font-medium opacity-90" id="description">Slnečno</div>
                
                <div class="grid mobile-grid sm:grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4 mt-4 sm:mt-6">
                    <div class="glass-card-dark rounded-xl p-3 sm:p-4 text-center">
                        <div class="text-xs sm:text-sm opacity-80 mb-1">Pocitová</div>
                        <div class="text-lg sm:text-xl font-bold" id="feelsLike">24°C</div>
                    </div>
                    <div class="glass-card-dark rounded-xl p-3 sm:p-4 text-center">
                        <div class="text-xs sm:text-sm opacity-80 mb-1">Vlhkosť</div>
                        <div class="text-lg sm:text-xl font-bold" id="humidity">65%</div>
                    </div>
                    <div class="glass-card-dark rounded-xl p-3 sm:p-4 text-center">
                        <div class="text-xs sm:text-sm opacity-80 mb-1">Vietor</div>
                        <div class="text-lg sm:text-xl font-bold" id="windSpeed">12 km/h</div>
                    </div>
                    <div class="glass-card-dark rounded-xl p-3 sm:p-4 text-center">
                        <div class="text-xs sm:text-sm opacity-80 mb-1">Tlak</div>
                        <div class="text-lg sm:text-xl font-bold" id="pressure">1013 hPa</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 7-Day Forecast -->
        <div class="max-w-6xl mx-auto slide-up">
            <h3 class="text-xl sm:text-2xl font-bold text-white mb-4 sm:mb-6 text-center">
                7-dňová predpoveď
            </h3>
            <div class="grid mobile-forecast sm:grid-cols-4 lg:grid-cols-7 gap-2 sm:gap-4" id="forecast">
                <!-- Forecast cards will be generated here -->
            </div>
        </div>

        <!-- Additional Info Section -->
        <div class="mt-8 sm:mt-12 text-center">
            <div class="glass-card rounded-2xl p-4 sm:p-6 max-w-md mx-auto">
                <p class="text-white/90 text-sm sm:text-base font-medium">
                    📡 Údaje poskytované v reálnom čase
                </p>
                <p class="text-white/70 text-xs sm:text-sm mt-2">
                    Posledná aktualizácia: <span id="lastUpdate">--:--</span>
                </p>
            </div>
        </div>

        <!-- Loading indicator -->
        <div id="loading" class="hidden fixed inset-0 bg-black/60 flex items-center justify-center z-50">
            <div class="glass-card rounded-2xl p-6 sm:p-8 text-center max-w-sm mx-4">
                <div class="loading-spinner mx-auto mb-4"></div>
                <p class="text-white font-medium text-base sm:text-lg">Načítavam údaje...</p>
                <p class="text-white/70 text-sm mt-2">Prosím čakaj</p>
            </div>
        </div>

        <!-- Error message -->
        <div id="errorMessage" class="hidden fixed top-4 left-4 right-4 sm:left-auto sm:right-4 sm:w-96 glass-card rounded-xl p-4 text-white z-50">
            <div class="flex items-center">
                <span class="text-2xl mr-3">⚠️</span>
                <div>
                    <p class="font-semibold">Chyba</p>
                    <p class="text-sm opacity-90" id="errorText">Niečo sa pokazilo</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentCity = 'Bratislava';
        let currentLat = 48.1486;
        let currentLon = 17.1077;

        // Enhanced weather code to icon mapping
        const weatherIcons = {
            0: '☀️', 1: '🌤️', 2: '⛅', 3: '☁️', 45: '🌫️', 48: '🌫️',
            51: '🌦️', 53: '🌦️', 55: '🌦️', 61: '🌧️', 63: '🌧️', 65: '🌧️',
            71: '🌨️', 73: '🌨️', 75: '🌨️', 77: '❄️', 80: '🌦️', 81: '🌧️',
            82: '⛈️', 85: '🌨️', 86: '🌨️', 95: '⛈️', 96: '⛈️', 99: '⛈️'
        };

        const weatherDescriptions = {
            0: 'Jasno', 1: 'Prevažne jasno', 2: 'Čiastočne oblačno', 3: 'Zamračené',
            45: 'Hmla', 48: 'Hmla s námrazou', 51: 'Slabé mrholenie', 53: 'Mierné mrholenie',
            55: 'Husté mrholenie', 61: 'Slabý dážď', 63: 'Mierny dážď', 65: 'Silný dážď',
            71: 'Slabé sneženie', 73: 'Mierné sneženie', 75: 'Silné sneženie', 77: 'Snehové zrná',
            80: 'Slabé prehánky', 81: 'Mierné prehánky', 82: 'Silné prehánky',
            85: 'Slabé snehové prehánky', 86: 'Silné snehové prehánky',
            95: 'Búrka', 96: 'Búrka s krupobitím', 99: 'Búrka so silným krupobitím'
        };

        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            document.getElementById('errorText').textContent = message;
            errorDiv.classList.remove('hidden');
            setTimeout(() => {
                errorDiv.classList.add('hidden');
            }, 5000);
        }

        function updateLastUpdate() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('sk-SK', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
            document.getElementById('lastUpdate').textContent = timeString;
        }

        async function getCoordinates(city) {
            try {
                const response = await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(city)}&count=1&language=sk&format=json`);
                const data = await response.json();
                
                if (data.results && data.results.length > 0) {
                    return {
                        lat: data.results[0].latitude,
                        lon: data.results[0].longitude,
                        name: data.results[0].name,
                        country: data.results[0].country
                    };
                }
                return null;
            } catch (error) {
                console.error('Error getting coordinates:', error);
                throw new Error('Nepodarilo sa nájsť mesto');
            }
        }

        async function fetchWeatherData(lat, lon) {
            try {
                const response = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,relative_humidity_2m,apparent_temperature,weather_code,surface_pressure,wind_speed_10m&daily=weather_code,temperature_2m_max,temperature_2m_min&timezone=auto`);
                
                if (!response.ok) {
                    throw new Error('Chyba pri načítavaní údajov');
                }
                
                const data = await response.json();
                return data;
            } catch (error) {
                console.error('Error fetching weather data:', error);
                throw new Error('Nepodarilo sa načítať údaje o počasí');
            }
        }

        function updateCurrentWeather(data, cityName, country) {
            const current = data.current;
            
            const displayName = country ? `${cityName}, ${country}` : cityName;
            document.getElementById('cityName').textContent = displayName;
            document.getElementById('temperature').textContent = `${Math.round(current.temperature_2m)}°C`;
            document.getElementById('feelsLike').textContent = `${Math.round(current.apparent_temperature)}°C`;
            document.getElementById('humidity').textContent = `${current.relative_humidity_2m}%`;
            document.getElementById('windSpeed').textContent = `${Math.round(current.wind_speed_10m)} km/h`;
            document.getElementById('pressure').textContent = `${Math.round(current.surface_pressure)} hPa`;
            
            const weatherCode = current.weather_code;
            document.getElementById('weatherIcon').textContent = weatherIcons[weatherCode] || '🌤️';
            document.getElementById('description').textContent = weatherDescriptions[weatherCode] || 'Neznáme';
            
            updateLastUpdate();
        }

        function updateForecast(data) {
            const daily = data.daily;
            const forecastContainer = document.getElementById('forecast');
            forecastContainer.innerHTML = '';

            const days = ['Ned', 'Pon', 'Uto', 'Str', 'Štv', 'Pia', 'Sob'];
            
            for (let i = 0; i < 7; i++) {
                const date = new Date(daily.time[i]);
                const dayName = i === 0 ? 'Dnes' : i === 1 ? 'Zajtra' : days[date.getDay()];
                
                const forecastCard = document.createElement('div');
                forecastCard.className = 'forecast-card glass-card-dark rounded-xl p-3 sm:p-4 text-white text-center';
                
                forecastCard.innerHTML = `
                    <div class="text-xs sm:text-sm font-semibold mb-2 opacity-90">${dayName}</div>
                    <div class="text-xl sm:text-2xl mb-2">${weatherIcons[daily.weather_code[i]] || '🌤️'}</div>
                    <div class="text-sm sm:text-lg font-bold">${Math.round(daily.temperature_2m_max[i])}°</div>
                    <div class="text-xs sm:text-sm opacity-70">${Math.round(daily.temperature_2m_min[i])}°</div>
                `;
                
                forecastContainer.appendChild(forecastCard);
                
                // Add animation delay for each card
                setTimeout(() => {
                    forecastCard.classList.add('slide-up');
                }, i * 100);
            }
        }

        async function loadWeather(city = currentCity) {
            const loadingDiv = document.getElementById('loading');
            loadingDiv.classList.remove('hidden');
            
            try {
                let lat = currentLat;
                let lon = currentLon;
                let cityName = city;
                let country = '';
                
                if (city !== currentCity) {
                    const coords = await getCoordinates(city);
                    if (coords) {
                        lat = coords.lat;
                        lon = coords.lon;
                        cityName = coords.name;
                        country = coords.country;
                        currentLat = lat;
                        currentLon = lon;
                        currentCity = cityName;
                    } else {
                        throw new Error('Mesto sa nenašlo. Skús iný názov.');
                    }
                }
                
                const weatherData = await fetchWeatherData(lat, lon);
                
                if (weatherData) {
                    updateCurrentWeather(weatherData, cityName, country);
                    updateForecast(weatherData);
                } else {
                    throw new Error('Nepodarilo sa načítať údaje o počasí');
                }
                
            } catch (error) {
                showError(error.message);
            } finally {
                loadingDiv.classList.add('hidden');
            }
        }

        function searchWeather() {
            const input = document.getElementById('cityInput');
            const city = input.value.trim();
            if (city) {
                loadWeather(city);
                input.value = '';
                input.blur(); // Hide mobile keyboard
            }
        }

        // Enhanced event listeners
        document.getElementById('cityInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchWeather();
            }
        });

        // Touch and accessibility improvements
        document.addEventListener('DOMContentLoaded', function() {
            // Add touch feedback for buttons
            const buttons = document.querySelectorAll('button');
            buttons.forEach(button => {
                button.addEventListener('touchstart', function() {
                    this.style.transform = 'scale(0.95)';
                });
                button.addEventListener('touchend', function() {
                    this.style.transform = 'scale(1)';
                });
            });
            
            // Load initial weather data
            loadWeather();
        });

        // Auto-refresh every 10 minutes
        setInterval(() => {
            loadWeather(currentCity);
        }, 600000);

        // Handle online/offline status
        window.addEventListener('online', () => {
            loadWeather(currentCity);
        });

        window.addEventListener('offline', () => {
            showError('Žiadne internetové pripojenie');
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9714577e50e6c2b1',t:'MTc1NTU1MDgzNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
